{
  "bundle": "/tmp/triage-bundle_node1_2026-01-17_140704.tar.gz",
  "hostdir": "triage_node1_2026-01-17_140704",
  "generated_at": "2026-01-17T14:07:22.148989",
  "findings": [
    {
      "rule_id": "NGINX_UPSTREAM_SELINUX",
      "priority": 10,
      "severity": "P0",
      "root_cause": "Nginx 反代被 SELinux 拦截（httpd_t 默认禁止主动网络连接）",
      "verify_steps": [
        "getenforce",
        "tail -n 50 /var/log/nginx/error.log"
      ],
      "fix_steps": [
        "setsebool -P httpd_can_network_connect 1",
        "systemctl restart nginx"
      ],
      "evidence_snippet": "xguest_mount_media --> on\nxguest_use_bluetooth --> on\nxserver_clients_write_xshm --> off\nxserver_execmem --> off\nxserver_object_manager --> off\nzabbix_can_network --> off\nzabbix_run_sudo --> off\nzarafa_setrlimit --> off\nzebra_write_config --> off\nzoneminder_anon_write --> off\nzoneminder_run_sudo --> off\n\n\n===== 40_nginx_error_tail.txt =====\n\n2025/12/28 01:29:07 [crit] 28920#28920: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:29:07 [crit] 28920#28920: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:29:07 [crit] 28920#28920: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:29:30 [notice] 28932#28932: signal process started\n2025/12/28 01:29:34 [crit] 28920#28920: *2 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:29:34 [crit] 28933#28933: *6 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:29:34 [crit] 28933#28933: *6 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:31:55 [crit] 28934#28934: *10 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:31:55 [crit] 28934#28934: *10 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:31:56 [crit] 28934#28934: *10 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:32:11 [notice] 28990#28990: signal process started\n2025/12/28 01:32:13 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:32:13 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:32:14 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:32:15 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:32:15 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\""
    },
    {
      "rule_id": "NGINX_UPSTREAM_REFUSED",
      "priority": 30,
      "severity": "P1",
      "root_cause": "上游端口拒绝：上游服务未监听/宕机/端口不对",
      "verify_steps": [
        "curl -I http://<upstream>:8080/",
        "ss -lntp | grep 8080"
      ],
      "fix_steps": [
        "确认 Tomcat/应用监听 8080",
        "检查防火墙/安全组放行 8080"
      ],
      "evidence_snippet": "2025/12/28 01:35:25 [crit] 29039#29039: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /poweredby.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/poweredby.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:35:25 [crit] 29039#29039: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:35:51 [crit] 29039#29039: *11 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:35:51 [crit] 29039#29039: *11 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:35:51 [crit] 29039#29039: *11 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /poweredby.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/poweredby.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:35:51 [crit] 29039#29039: *11 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:36:33 [notice] 29066#29066: signal process started\n2025/12/28 01:37:43 [crit] 29078#29078: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:37:43 [crit] 29078#29078: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:37:43 [crit] 29078#29078: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /poweredby.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/poweredby.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:37:43 [crit] 29078#29078: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:38:24 [crit] 29078#29078: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:38:24 [crit] 29078#29078: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:38:24 [crit] 29079#29079: *2 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /poweredby.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/poweredby.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:38:24 [crit] 29079#29079: *2 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 14:05:00 [error] 1183#1183: *2 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 14:05:00 [error] 1183#1183: *2 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 14:05:00 [error] 1183#1183: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /poweredby.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/poweredby.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 14:05:01 [error] 1183#1183: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 14:05:17 [error] 1183#1183: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 14:05:17 [error] 1183#1183: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 14:05:17 [error] 1183#1183: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /poweredby.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/poweredby.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 14:05:17 [error] 1183#1183: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 14:59:59 [error] 1602#1602: *1 connect() failed (111: Connection refused) while connecting to upstream, client: 192.168.200.100, server: _, request: \"HEAD / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\""
    }
  ],
  "primary_finding": {
    "rule_id": "NGINX_UPSTREAM_SELINUX",
    "priority": 10,
    "severity": "P0",
    "root_cause": "Nginx 反代被 SELinux 拦截（httpd_t 默认禁止主动网络连接）",
    "verify_steps": [
      "getenforce",
      "tail -n 50 /var/log/nginx/error.log"
    ],
    "fix_steps": [
      "setsebool -P httpd_can_network_connect 1",
      "systemctl restart nginx"
    ],
    "evidence_snippet": "xguest_mount_media --> on\nxguest_use_bluetooth --> on\nxserver_clients_write_xshm --> off\nxserver_execmem --> off\nxserver_object_manager --> off\nzabbix_can_network --> off\nzabbix_run_sudo --> off\nzarafa_setrlimit --> off\nzebra_write_config --> off\nzoneminder_anon_write --> off\nzoneminder_run_sudo --> off\n\n\n===== 40_nginx_error_tail.txt =====\n\n2025/12/28 01:29:07 [crit] 28920#28920: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:29:07 [crit] 28920#28920: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:29:07 [crit] 28920#28920: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:29:30 [notice] 28932#28932: signal process started\n2025/12/28 01:29:34 [crit] 28920#28920: *2 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:29:34 [crit] 28933#28933: *6 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:29:34 [crit] 28933#28933: *6 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:31:55 [crit] 28934#28934: *10 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:31:55 [crit] 28934#28934: *10 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:31:56 [crit] 28934#28934: *10 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:32:11 [notice] 28990#28990: signal process started\n2025/12/28 01:32:13 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:32:13 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:32:14 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /favicon.ico HTTP/1.1\", upstream: \"http://192.168.200.200:8080/favicon.ico\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\"\n2025/12/28 01:32:15 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET / HTTP/1.1\", upstream: \"http://192.168.200.200:8080/\", host: \"192.168.200.100\"\n2025/12/28 01:32:15 [crit] 28992#28992: *1 connect() to 192.168.200.200:8080 failed (13: Permission denied) while connecting to upstream, client: 192.168.200.1, server: _, request: \"GET /nginx-logo.png HTTP/1.1\", upstream: \"http://192.168.200.200:8080/nginx-logo.png\", host: \"192.168.200.100\", referrer: \"http://192.168.200.100/\""
  }
}